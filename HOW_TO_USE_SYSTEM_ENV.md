# 如何使用系统环境变量功能

## ✅ 功能已正常工作

根据控制台日志，系统环境变量扫描功能已经正常工作：
```
[EnvManager] 开始获取系统环境变量...
[EnvManager] process.env 包含 119 个键
[EnvManager] 提取了 119 个有效环境变量
```

## 📋 使用步骤

### 方法 1：首次启动时的自动提示

如果您是第一次打开应用（还没有任何配置）：

1. **启动应用**
   ```bash
   pnpm dev
   ```

2. **等待提示**
   - 应用会在 1 秒后弹出提示对话框
   - 提示内容：`检测到本机有 119 个系统环境变量，是否查看？`

3. **点击"查看"按钮**
   - 会打开系统环境变量查看器
   - 显示所有 119 个环境变量

### 方法 2：手动打开查看器

1. **找到标题栏右侧的按钮**
   - 应用顶部标题栏（紫色渐变背景）
   - 右侧有一个按钮：`系统环境变量 (119)`
   - 数字 119 表示当前系统有 119 个环境变量

2. **点击按钮**
   - 打开系统环境变量查看器对话框

## 🔍 查看器界面说明

打开后您会看到：

### 顶部工具栏
```
[🔍 搜索环境变量名或值...]    总计: 119 个变量   [📥 导入全部到新配置]
```

### 变量列表
```
┌────┬──────────────┬───────────────────┬────────┐
│ #  │ 变量名       │ 变量值            │ 操作   │
├────┼──────────────┼───────────────────┼────────┤
│ 1  │ PATH         │ C:\Windows\...    │ [导入] │
│ 2  │ NODE_ENV     │ development       │ [导入] │
│ 3  │ USERNAME     │ YourName          │ [导入] │
│ ...│ ...          │ ...               │ [导入] │
└────┴──────────────┴───────────────────┴────────┘
```

### 底部分页控制
```
总计 119, 显示 20 条/页  [20/50/100/200]  [<] [1] [2] [3] [>]
```

## 💡 功能使用

### 1. 搜索环境变量

**示例：查找 PATH 变量**
1. 在搜索框输入：`PATH`
2. 列表会实时过滤，只显示包含 "PATH" 的变量
3. 可以搜索变量名或变量值

**示例：查找所有 Node.js 相关变量**
1. 在搜索框输入：`NODE`
2. 会显示所有包含 "NODE" 的变量，如：
   - `NODE_ENV`
   - `NODE_PATH`
   - `npm_config_prefix`
   - 等等

### 2. 导入单个变量

**场景：只需要某个特定变量**

1. **先选择或创建一个配置**
   - 在左侧配置列表中点击一个配置
   - 或创建新配置

2. **在查看器中找到需要的变量**
   - 可以使用搜索功能
   - 或者直接浏览列表

3. **点击"导入"按钮**
   - 点击该变量所在行的"导入"按钮
   - 变量会被添加到当前选中的配置中
   - 显示成功提示：`已导入变量: XXX`

**示例：导入 NODE_ENV**
```
1. 搜索 "NODE_ENV"
2. 点击该行的[导入]按钮
3. 变量被添加到当前配置
```

### 3. 导入全部变量

**场景：想要管理所有系统环境变量**

1. **打开系统环境变量查看器**

2. **点击"导入全部到新配置"按钮**
   - 所有 119 个环境变量会被导入
   - 自动创建名为"系统环境变量"的新配置
   - 显示成功提示

3. **查看新创建的配置**
   - 左侧列表会出现"系统环境变量"配置
   - 点击选中它
   - 右侧会显示所有 119 个变量

4. **编辑或删除不需要的变量**
   - 可以直接在右侧编辑器中修改值
   - 删除不需要的变量

## 🎯 实用场景

### 场景 1：快速了解系统配置

**目的**：查看系统当前有哪些环境变量

1. 点击"系统环境变量 (119)"按钮
2. 浏览或搜索查看所有变量
3. 了解系统配置情况

### 场景 2：迁移现有环境变量

**目的**：将系统环境变量纳入 SwitchEnv 管理

1. 导入全部系统环境变量
2. 在新配置中查看和编辑
3. 删除不需要管理的变量
4. 保留重要的环境变量用于切换

### 场景 3：选择性导入开发环境变量

**目的**：只导入开发相关的环境变量

1. 创建"开发环境"配置
2. 打开系统环境变量查看器
3. 搜索并导入需要的变量：
   - 搜索 "NODE" → 导入 Node.js 相关
   - 搜索 "JAVA" → 导入 Java 相关
   - 搜索 "PYTHON" → 导入 Python 相关
   - 等等

### 场景 4：对比和同步

**目的**：对比系统变量和配置变量的差异

1. 查看系统环境变量
2. 记住某些变量的值
3. 切换到你的配置查看
4. 对比是否需要更新

## ⚠️ 注意事项

### 1. 大量变量
- 系统通常有几十到上百个环境变量
- 使用搜索功能可以快速定位
- 使用分页功能避免一次显示太多

### 2. 敏感信息
- 某些环境变量可能包含敏感信息
- 导入前请检查变量内容
- 导出配置时注意不要泄露密码等

### 3. PATH 变量
- PATH 变量通常很长（包含多个路径）
- 表格中会自动截断显示
- 鼠标悬停可以看到完整内容

### 4. 只读查看
- 系统环境变量查看器只能查看和导入
- 不能直接修改系统环境变量
- 导入后可以在配置中修改值

### 5. 实时性
- 显示的是应用启动时的环境变量
- 如果系统环境变量改变，需要重启应用

## 🐛 故障排查

### 问题 1：看不到系统环境变量按钮

**解决方案**：
- 检查应用是否正常启动
- 刷新页面（Ctrl + R）
- 重启应用

### 问题 2：变量数量显示为 0

**解决方案**：
- 查看控制台是否有错误
- 重启应用
- 检查是否有权限问题

### 问题 3：无法导入变量

**解决方案**：
- 确保已选中一个配置（单个导入时）
- 检查控制台错误信息
- 尝试刷新页面

### 问题 4：中文显示乱码（终端日志）

**说明**：
- 这是 PowerShell 终端编码问题
- 不影响应用功能
- 应用界面中的中文显示正常

## 📊 当前状态

根据您的系统：
- ✅ 系统环境变量扫描功能正常
- ✅ 成功检测到 119 个环境变量
- ✅ 应用正常运行
- ✅ 所有功能可用

## 🎉 开始使用

现在您可以：
1. 在应用中点击"系统环境变量 (119)"按钮
2. 查看所有 119 个系统环境变量
3. 搜索、浏览、导入需要的变量
4. 开始管理您的环境配置！

祝使用愉快！🚀
