# 系统环境变量扫描功能

## 新增功能说明

### ✨ 启动时自动扫描系统环境变量

应用程序现在会在启动时自动扫描本机的所有系统环境变量，并提供以下功能：

### 功能特性

#### 1. 自动扫描和提示
- ✅ 应用启动时自动扫描系统环境变量
- ✅ 如果没有任何配置，会自动弹出提示询问是否查看系统环境变量
- ✅ 显示系统环境变量总数

#### 2. 系统环境变量查看器
- ✅ 标题栏新增"系统环境变量"按钮，显示变量总数
- ✅ 弹窗展示所有系统环境变量（变量名和值）
- ✅ 表格形式展示，清晰易读
- ✅ 支持搜索功能（可搜索变量名或值）
- ✅ 分页显示（可选择每页 20/50/100/200 条）
- ✅ 按变量名排序

#### 3. 导入功能
- ✅ **导入全部**：将所有系统环境变量作为新配置导入
- ✅ **单个导入**：选择性导入某个环境变量到当前配置
- ✅ 导入后自动保存

## 使用方法

### 方法 1：首次启动自动提示

1. **首次启动应用**（没有任何配置时）
2. 等待 1 秒后会弹出提示：
   ```
   检测到本机有 XXX 个系统环境变量，是否查看？
   ```
3. 点击"查看"按钮，打开系统环境变量查看器

### 方法 2：手动查看

1. 点击标题栏右侧的 **"系统环境变量 (XXX)"** 按钮
2. 打开系统环境变量查看器

## 系统环境变量查看器界面

### 界面布局

```
┌─────────────────────────────────────────────────────┐
│ 系统环境变量                                    [×] │
├─────────────────────────────────────────────────────┤
│ [搜索框]                      总计: XXX 个变量      │
│                           [导入全部到新配置] 按钮   │
├─────────────────────────────────────────────────────┤
│ #  │ 变量名         │ 变量值              │ 操作   │
├────┼───────────────┼────────────────────┼────────┤
│ 1  │ PATH          │ C:\Windows\...      │ [导入] │
│ 2  │ NODE_ENV      │ development         │ [导入] │
│ 3  │ ...           │ ...                 │ [导入] │
├─────────────────────────────────────────────────────┤
│           [分页控制器]                               │
└─────────────────────────────────────────────────────┘
```

### 功能说明

#### 搜索功能
- 在搜索框输入关键词
- 实时过滤变量名或变量值
- 支持大小写不敏感搜索

#### 导入全部
1. 点击"导入全部到新配置"按钮
2. 所有系统环境变量会创建为一个新配置
3. 配置名称：`系统环境变量`
4. 描述：`从本机系统导入的环境变量`

#### 单个导入
1. 在表格中找到要导入的变量
2. 点击该行的"导入"按钮
3. 变量会添加到当前选中的配置中
4. 如果没有选中配置，会提示先选择配置

#### 分页控制
- 每页显示数量可选：20/50/100/200
- 支持跳转到指定页
- 显示总数和当前页

## 使用场景

### 场景 1: 快速了解系统环境

当你需要查看系统当前配置的所有环境变量时：

1. 点击"系统环境变量"按钮
2. 浏览所有变量
3. 使用搜索功能查找特定变量

### 场景 2: 从系统迁移环境变量

当你想将系统环境变量纳入管理时：

1. 打开系统环境变量查看器
2. 点击"导入全部到新配置"
3. 在新创建的配置中编辑和管理

### 场景 3: 选择性导入

当你只需要某些系统环境变量时：

1. 创建或选择一个配置
2. 打开系统环境变量查看器
3. 搜索需要的变量
4. 点击"导入"按钮逐个导入

### 场景 4: 环境变量对比

对比系统环境变量和配置中的变量：

1. 查看系统环境变量
2. 切换到你的配置
3. 对比差异，按需同步

## 示例：导入 Node.js 相关环境变量

### 步骤

1. **打开系统环境变量查看器**
   - 点击标题栏的"系统环境变量"按钮

2. **搜索 Node 相关变量**
   - 在搜索框输入 `NODE`
   - 会显示所有包含 NODE 的变量，如：
     - `NODE_ENV`
     - `NODE_PATH`
     - `npm_config_*`

3. **选择性导入**
   - 先在左侧选择一个配置（或创建新配置）
   - 点击想要的变量旁边的"导入"按钮
   - 重复操作导入所有需要的变量

4. **或者导入全部**
   - 点击"导入全部到新配置"
   - 所有系统环境变量会被导入为新配置
   - 然后可以删除不需要的变量

## 技术实现

### 新增文件

#### 1. SystemEnvDialog.vue
系统环境变量查看器组件，提供：
- 变量列表展示
- 搜索功能
- 分页功能
- 导入功能

#### 2. envManager.ts 新增方法
```typescript
// 获取系统环境变量
getSystemEnvVariables(): EnvVariable[]

// 导入系统环境变量到新配置
importSystemEnvVariables(): EnvProfile
```

### IPC 通信

新增两个 IPC 接口：
- `get-system-env`: 获取系统环境变量列表
- `import-system-env`: 导入系统环境变量为新配置

### 应用启动流程

```
启动应用
  ↓
加载已保存的配置
  ↓
扫描系统环境变量
  ↓
检查是否有配置
  ↓
├─ 有配置：正常显示
└─ 无配置：弹出提示询问是否查看系统环境变量
```

## 注意事项

1. **系统环境变量数量**
   - Windows 系统通常有 50-100+ 个环境变量
   - 使用分页和搜索功能可以更方便地查找

2. **敏感信息**
   - 系统环境变量可能包含敏感信息（如密钥、密码）
   - 导出配置时注意不要泄露

3. **PATH 变量**
   - PATH 变量通常很长
   - 表格会自动截断，悬停可查看完整内容

4. **只读展示**
   - 系统环境变量查看器只能查看和导入
   - 不能直接修改系统环境变量
   - 导入后可以在配置中修改

## 扩展建议

### 未来可以添加的功能

1. **环境变量分类**
   - 按类型分组（系统变量、用户变量）
   - 按前缀分组（NODE_*, npm_*, JAVA_*, etc.）

2. **智能推荐**
   - 根据项目类型推荐需要的环境变量
   - 常用变量快速选择

3. **变量对比**
   - 对比系统变量和配置变量的差异
   - 高亮显示不同的值

4. **批量操作**
   - 批量选择导入
   - 按条件过滤导入

5. **导出到系统**
   - 将配置中的变量应用到系统环境变量（需要管理员权限）

## 总结

系统环境变量扫描功能为 SwitchEnv 提供了更强大的初始化能力：

- ✅ **自动发现**：启动时自动扫描系统环境
- ✅ **友好提示**：首次使用时引导用户
- ✅ **灵活导入**：支持全部导入或选择性导入
- ✅ **便捷查看**：随时查看系统环境变量
- ✅ **搜索过滤**：快速找到需要的变量

这使得从系统环境迁移到 SwitchEnv 管理变得更加简单高效！
