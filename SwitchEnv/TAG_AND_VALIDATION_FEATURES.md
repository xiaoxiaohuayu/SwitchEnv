# 配置分组/标签系统 & 环境变量验证器 - 功能说明

## ✅ 功能已全部完成并集成

所有新功能已经成功集成到应用中，无编译错误，可以立即使用！

## 🏷️ 配置分组/标签系统

### 功能概述

标签和分组系统让您可以更好地组织和管理多个环境配置，特别适合管理多个项目或多种环境的场景。

### 核心功能

#### 1. 标签管理

**创建标签**
1. 点击配置列表顶部的"标签"按钮
2. 在弹出的标签管理对话框中：
   - 输入标签名称（如："开发"、"测试"、"生产"）
   - 选择标签颜色（点击色块选择器）
   - 点击"添加标签"按钮
3. 标签创建后会自动保存到 localStorage

**编辑标签**
1. 在标签管理对话框中找到要编辑的标签
2. 点击标签旁边的"编辑"按钮
3. 修改名称或颜色
4. 点击"保存"确认修改

**删除标签**
1. 在标签管理对话框中找到要删除的标签
2. 点击标签右侧的 ×  按钮
3. 标签会从系统中删除，并自动从所有配置中移除

#### 2. 为配置添加标签

**方式一：在配置卡片上添加**
1. 在配置列表中找到要标记的配置
2. 配置会显示已添加的标签（彩色标签）
3. 点击标签的 × 可以移除该标签

**方式二：通过编辑配置**
- 未来可以在编辑对话框中选择标签（可扩展功能）

#### 3. 按标签筛选配置

1. 在配置列表顶部找到"按标签筛选"下拉框
2. 点击打开，显示所有可用标签
3. 选择一个或多个标签
4. 列表会自动只显示包含这些标签的配置
5. 点击下拉框的 × 清除筛选

#### 4. 分组功能

**设置分组**
- 在创建或编辑配置时可以设置分组名称
- 分组用于更粗粒度的配置归类

**按分组筛选**
1. 在配置列表顶部找到"所有分组"下拉框
2. 选择一个分组名称
3. 只显示该分组下的配置
4. 清除选择查看所有配置

### 使用场景示例

#### 场景 1：多项目管理

```
标签设置：
- 🔵 项目A (蓝色)
- 🟢 项目B (绿色)
- 🟡 项目C (黄色)
- 🔴 开发 (红色)
- 🟠 生产 (橙色)

配置示例：
- "项目A开发环境" → 标签: [项目A, 开发]
- "项目A生产环境" → 标签: [项目A, 生产]
- "项目B开发环境" → 标签: [项目B, 开发]
- "项目B生产环境" → 标签: [项目B, 生产]

筛选操作：
- 选择"项目A"标签 → 只看项目A的所有配置
- 选择"开发"标签 → 只看所有项目的开发环境
- 同时选择"项目A"和"开发" → 只看项目A的开发环境
```

#### 场景 2：技术栈分类

```
标签设置：
- Vue (绿色)
- React (蓝色)
- Node.js (绿色)
- Python (黄色)
- 数据库 (紫色)

配置示例：
- "Vue前端开发" → 标签: [Vue]
- "React管理后台" → 标签: [React]
- "Node.js API服务" → 标签: [Node.js, 数据库]
```

#### 场景 3：分组 + 标签组合

```
分组：
- 前端项目
- 后端服务
- 数据库配置

标签：
- 开发
- 测试  
- 生产

配置示例：
分组"前端项目" + 标签"开发" → Vue开发环境
分组"后端服务" + 标签"生产" → API生产配置
```

## ✅ 环境变量验证器

### 功能概述

验证器帮助您在使用配置前检测潜在问题，避免因配置错误导致的运行时错误。

### 验证规则

#### 1. 变量名验证

**格式要求**
- ✅ 正确格式：大写字母、数字、下划线
- ✅ 必须以字母或下划线开头
- ❌ 错误示例：`api-key`（包含连字符）
- ✅ 正确示例：`API_KEY`

**保留关键字警告**
- 系统会警告修改保留变量（如 PATH, HOME, USER）
- 类型：⚠️ 警告（可以继续使用，但需注意）

**空值检查**
- ❌ 变量名不能为空
- 类型：❌ 错误（必须修复）

#### 2. 变量值验证

**必填项检查**
- 如果变量标记为"必填"，值不能为空
- 在变量表格中勾选"必填"复选框
- 类型：❌ 错误

**长度限制**
- 变量值不应超过 10,000 字符
- 类型：⚠️ 警告

**URL 格式验证**
- 变量名包含 "URL" 时自动验证
- 检查是否为有效的 URL 格式
- 类型：⚠️ 警告
- 示例：`API_URL = "http://example.com"` ✅

**端口号验证**
- 变量名包含 "PORT" 时自动验证
- 必须是 0-65535 之间的数字
- 类型：❌ 错误
- 示例：
  - `PORT = "3000"` ✅
  - `PORT = "99999"` ❌

**PATH 格式验证**
- 变量名包含 "PATH" 时自动验证
- 检查路径分隔符和空路径
- Windows 使用 `;`，Linux/Mac 使用 `:`
- 类型：⚠️ 警告

**特殊字符检查**
- 检测控制字符和不可见字符
- 类型：⚠️ 警告

#### 3. 配置级验证

**重复变量检测**
- 自动检测同名变量
- 显示重复次数
- 类型：❌ 错误
- 示例：`NODE_ENV` 出现 2 次 ❌

### 使用方法

#### 方式一：手动验证

1. 选择一个配置
2. 点击变量编辑器工具栏的"验证配置"按钮
3. 右侧会弹出验证面板（抽屉）
4. 查看验证结果：
   - ✅ 绿色：配置正确
   - ⚠️ 橙色：有警告
   - ❌ 红色：有错误

#### 方式二：查看详细错误

在验证面板中：
- **验证摘要**：显示错误和警告总数
- **问题详情**：列出所有问题
  - 每个问题显示：
    - 变量名
    - 错误类型图标
    - 详细错误信息

#### 验证结果示例

```
┌─────────────────────────────────────┐
│ 配置验证          [重新验证]       │
├─────────────────────────────────────┤
│ ⚠️ 配置有警告                       │
│ 发现 0 个错误，3 个警告             │
├─────────────────────────────────────┤
│ 问题详情                            │
│                                     │
│ ⚠️ api_key                          │
│    变量名应使用大写字母             │
│                                     │
│ ⚠️ API_URL                          │
│    URL 格式可能不正确               │
│                                     │
│ ⚠️ PATH                             │
│    此变量名为系统保留               │
└─────────────────────────────────────┘
```

### 最佳实践

#### 创建配置时

1. 添加变量后点击"验证配置"
2. 修复所有错误
3. 考虑修复警告
4. 再次验证确认无误
5. 保存或激活配置

#### 变量命名建议

- ✅ 使用大写字母：`API_KEY`, `NODE_ENV`
- ✅ 使用下划线分隔：`DB_HOST`, `APP_NAME`
- ❌ 避免小写：`api_key` → 改为 `API_KEY`
- ❌ 避免连字符：`api-key` → 改为 `API_KEY`
- ❌ 避免特殊字符：`api.key` → 改为 `API_KEY`

#### 必填项使用

1. 勾选"必填"复选框标记关键变量
2. 例如：数据库连接、API 密钥
3. 验证器会确保这些变量有值

#### 定期验证

- 修改配置后重新验证
- 切换环境前验证
- 导入配置后验证

## 🎯 综合使用场景

### 场景：管理多个前端项目

```
1. 创建标签
   - Vue项目 (绿色)
   - React项目 (蓝色)
   - 开发环境 (黄色)
   - 生产环境 (红色)

2. 创建配置
   配置1: Vue商城前端-开发
   - 标签: [Vue项目, 开发环境]
   - 分组: 前端项目
   - 变量:
     ✓ VUE_APP_API_URL (必填)
     ✓ VUE_APP_ENV
     ✓ VUE_APP_PORT

3. 验证配置
   - 点击"验证配置"
   - 检查：
     ✓ 变量名格式正确
     ✓ API_URL 格式有效
     ✓ PORT 在有效范围
     ✓ 必填项都有值
     ✓ 无重复变量

4. 使用筛选
   - 选择"Vue项目"标签 → 看所有Vue配置
   - 选择"开发环境"标签 → 看所有开发配置
   - 选择"前端项目"分组 → 看所有前端配置
```

## 📊 功能对比

### 标签 vs 分组

| 特性 | 标签 | 分组 |
|------|------|------|
| 数量 | 一个配置可以有多个标签 | 一个配置只能属于一个分组 |
| 可视化 | 彩色标签，更直观 | 文本显示 |
| 筛选 | 支持多标签组合筛选 | 只能选择一个分组 |
| 用途 | 细粒度分类（环境、技术栈） | 粗粒度归类（项目、模块） |

### 错误 vs 警告

| 类型 | 说明 | 建议 |
|------|------|------|
| ❌ 错误 | 严重问题，可能导致程序无法运行 | 必须修复后才使用 |
| ⚠️ 警告 | 潜在问题，但不影响基本功能 | 建议修复，但可继续使用 |

## 🚀 快速上手

### 5分钟入门

1. **创建第一个标签**
   - 点击"标签"按钮
   - 输入"开发环境"，选择蓝色
   - 点击"添加标签"

2. **为配置添加标签**
   - 在配置卡片上看到标签显示
   - 系统会自动关联

3. **验证配置**
   - 选择一个配置
   - 点击"验证配置"
   - 查看结果并修复问题

4. **使用筛选**
   - 选择"开发环境"标签
   - 只看开发相关配置

## 💡 高级技巧

### 标签颜色方案建议

- 🔴 红色：生产环境（重要）
- 🟡 黄色：测试环境
- 🔵 蓝色：开发环境
- 🟢 绿色：正常状态
- 🟠 橙色：临时配置
- 🟣 紫色：特殊用途

### 批量操作技巧

1. 创建一组相关标签
2. 为多个配置快速添加相同标签
3. 使用标签筛选批量查看

### 验证器技巧

1. 创建配置模板前先验证
2. 使用必填标记保护关键变量
3. 定期检查所有配置的验证状态

## ✅ 功能清单

### 标签系统
- [x] 创建标签（名称 + 颜色）
- [x] 编辑标签
- [x] 删除标签
- [x] 为配置添加标签
- [x] 从配置移除标签
- [x] 按标签筛选配置
- [x] 多标签组合筛选
- [x] localStorage 持久化

### 分组系统
- [x] 设置配置分组
- [x] 自动提取所有分组
- [x] 按分组筛选
- [x] 分组信息展示

### 验证器
- [x] 变量名格式验证
- [x] 变量值验证
- [x] 必填项检查
- [x] 重复变量检测
- [x] URL 格式验证
- [x] 端口号验证
- [x] PATH 格式验证
- [x] 特殊字符检测
- [x] 保留关键字警告
- [x] 验证摘要统计
- [x] 错误/警告分级
- [x] 可视化验证结果

## 🎉 总结

这两个功能极大地提升了 SwitchEnv 的专业性和易用性：

- **标签/分组系统**：让配置管理井井有条
- **验证器**：确保配置正确无误，减少调试时间

现在您可以启动应用，立即体验这些强大的新功能！

```bash
pnpm dev
```

祝使用愉快！🚀
